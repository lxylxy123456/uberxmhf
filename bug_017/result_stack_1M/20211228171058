fail
11

eXtensible Modular Hypervisor Framework (XMHF) v6.1.0
Build revision: xmhf64-050a8138efa5d1899b06c607d8da146c11a4bc48

INIT(early): initializing, total modules=3
INIT(early): detected an Intel CPU
Checking whether MBI module 2 is SINIT...
YES! SINIT found @ 0x101000, 35776 bytes

Finding SMP info. via ACPI...
ACPI RSDP at 0x000f5870
ACPI RSDT at 0x1ffe1a1c
	len=0x00000034, headerlen=0x00000024, numentries=4
ACPI MADT at 0x1ffe192c
	len=0x00000090, record-length=100 bytes
rec type=0x00, length=8 bytes, flags=0x00000001, id=0x00
rec type=0x00, length=8 bytes, flags=0x00000001, id=0x01
rec type=0x00, length=8 bytes, flags=0x00000001, id=0x02
rec type=0x00, length=8 bytes, flags=0x00000001, id=0x03
rec type=0x01, length=12 bytes, flags=0xfec00000, id=0x00
rec type=0x02, length=10 bytes, flags=0x00000002, id=0x00
rec type=0x02, length=10 bytes, flags=0x00000005, id=0x05
rec type=0x02, length=10 bytes, flags=0x00000009, id=0x09
rec type=0x02, length=10 bytes, flags=0x0000000a, id=0x0a
rec type=0x02, length=10 bytes, flags=0x0000000b, id=0x0b
rec type=0x04, length=6 bytes, flags=0x50480100, id=0x00
original system E820 map follows:

0x0000000000000000, size=0x000000000009fc00 (1)
0x000000000009fc00, size=0x0000000000000400 (2)
0x00000000000f0000, size=0x0000000000010000 (2)
0x0000000000100000, size=0x000000001fee0000 (1)
0x000000001ffe0000, size=0x0000000000020000 (2)
0x00000000feffc000, size=0x0000000000004000 (2)
0x00000000fffc0000, size=0x0000000000040000 (2)
proceeding to revise E820...
E820 revision complete.
revised system E820 map follows:

0x0000000000000000, size=0x000000000009fc00 (1)
0x000000000009fc00, size=0x0000000000000400 (2)
0x00000000000f0000, size=0x0000000000010000 (2)
0x0000000000100000, size=0x000000000ff00000 (1)
0x0000000010000000, size=0x000000000a400000 (2)
0x000000001a400000, size=0x0000000005be0000 (1)
0x000000001ffe0000, size=0x0000000000020000 (2)
0x00000000feffc000, size=0x0000000000004000 (2)
0x00000000fffc0000, size=0x0000000000040000 (2)
    INIT(early): *UNTRUSTED* gold runtime: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    INIT(early): *UNTRUSTED* gold runtime: 00 00 00 00
hashandprint: processing 0x0a053000 bytes at addr 0x10200000
    INIT(early): *UNTRUSTED* comp runtime: : 77 ca 4b 31 53 3f 30 71 a3 d3 48 04 d7 0e f1 9a a9 96 db 18

    INIT(early): *UNTRUSTED* gold SL low 64K: c8 3b ce ea e6 bb 65 e1 f6 d4 e6 a3 e0 d0 70 20
    INIT(early): *UNTRUSTED* gold SL low 64K: 61 51 38 12
hashandprint: processing 0x00010000 bytes at addr 0x10000000
    INIT(early): *UNTRUSTED* comp SL low 64K: : c8 3b ce ea e6 bb 65 e1 f6 d4 e6 a3 e0 d0 70 20 61 51 38 12

    INIT(early): *UNTRUSTED* gold SL above 64K: 26 cd 5d 0e 54 05 ef e1 15 05 5d d4 a5 52 0e be
    INIT(early): *UNTRUSTED* gold SL above 64K: 47 6a 52 8a
hashandprint: processing 0x001f0000 bytes at addr 0x10010000
    INIT(early): *UNTRUSTED* comp SL above 64K): : 26 cd 5d 0e 54 05 ef e1 15 05 5d d4 a5 52 0e be 47 6a 52 8a

INIT(early): relocated hypervisor binary image to 0x10000000
INIT(early): 2M aligned size = 0x0a400000
INIT(early): un-aligned size = 0x0a253000
setupvcpus: cpustacks range 0x01e1f000-0x01e3f000 in 0x00004000 chunks
setupvcpus: vcpubuffers range 0x01e0b080-0x01e16a00 in 0x00001730 chunks
CPU #0: vcpu_vaddr_ptr=0x01e0b080, esp=0x01e23000
CPU #1: vcpu_vaddr_ptr=0x01e0c7b0, esp=0x01e27000
CPU #2: vcpu_vaddr_ptr=0x01e0dee0, esp=0x01e2b000
CPU #3: vcpu_vaddr_ptr=0x01e0f610, esp=0x01e2f000
Sending INIT IPI to all APs...Done.
Sending SIPI-0...
AP(0x02): Waiting for DRTM establishment...
AP(0x01): Waiting for DRTM establishment...Done.
AP(0x03): Waiting for DRTM establishment...
Sending SIPI-1...Done.
APs should be awake!
BSP(0x00): Rallying APs...
BSP(0x00): APs ready, doing DRTM...
LAPIC base and status=0xfee00900
Sending INIT IPI to all APs...
Done.

INIT(early): sent INIT IPI to APs
****** NO DRTM startup ******

slbase=0x10000000, sl_entry_point_offset=0x00003080
SL entry point to transfer control to: 0x10003080
SL(early-init): at 0x10000000, starting...
SL: slpb at = 0x00010000
	errorHandler=0x00000000
	isEarlyInit=0x00000001
	numE820Entries=9
	system memory map buffer at 0x00010010
	numCPUEntries=4
	cpuinfo buffer at 0x00010514
	runtime size= 168112128 bytes
	OS bootmodule at 0x00100000, size=512 bytes
	cmdline = "serial=115200,8n1,0x3f8"
SL: RDTSC before_drtm 0x0, after_drtm 0x658f742cb
SL: [PERF] RDTSC DRTM elapsed cycles: 0x658f742cb
SL: runtime at 0x10200000; size=0x0a053000 bytes adjusted to 0x0a200000 bytes (2M aligned)
SL: RPB, magic=0xf00ddead
xmhf_baseplatform_arch_x86_64_pci_initialize: PCI type-1 access supported.
xmhf_baseplatform_arch_x86_64_pci_initialize: PCI bus enumeration follows:
xmhf_baseplatform_arch_x86_64_pci_initialize: Done with PCI bus enumeration.
SL: setup runtime TSS.
SL (xmhf_sl_arch_x86_64_setup_runtime_paging): runtime_spa=0000000010200000, runtime_sva=0000000010200000, totalsize=000000000a200000
	pa xpml4=0x0x994d000, xpdpt=0x0x994e000, xpdt=0x0x994f000
SL: setup runtime paging structures.
Transferring control to runtime
runtime initializing...
xmhf_baseplatform_arch_x86_64_pci_initialize: PCI type-1 access supported.
xmhf_baseplatform_arch_x86_64_pci_initialize: PCI bus enumeration follows:
xmhf_baseplatform_arch_x86_64_pci_initialize: Done with PCI bus enumeration.
Number of E820 entries = 9
0x0000000000000000, size=0x000000000009fc00 (1)
0x000000000009fc00, size=0x0000000000000400 (2)
0x00000000000f0000, size=0x0000000000010000 (2)
0x0000000000100000, size=0x000000000ff00000 (1)
0x0000000010000000, size=0x000000000a400000 (2)
0x000000001a400000, size=0x0000000005be0000 (1)
0x000000001ffe0000, size=0x0000000000020000 (2)
0x00000000feffc000, size=0x0000000000004000 (2)
0x00000000fffc0000, size=0x0000000000040000 (2)
Number of MP entries = 4
CPU #0: bsp=1, lapic_id=0x00
CPU #1: bsp=0, lapic_id=0x01
CPU #2: bsp=0, lapic_id=0x02
CPU #3: bsp=0, lapic_id=0x03
xmhf_xcphandler_arch_initialize: setting up runtime IDT...
xmhf_xcphandler_arch_initialize: IDT setup done.
Runtime: Re-initializing DMA protection...
Runtime: Protected SL+Runtime (10000000-1a253000) from DMA.
BSP: Using APIC to awaken APs...
BSP: APs should be awake.
Relinquishing BSP thread and moving to common...
BSP rallying APs...
BSP(0x00): My RSP is 0x0000000019a53000
APs all awake...Setting them free...
AP(0x03): My RSP is 0x0000000019d53000, proceeding...
CPU(0x00): UNRESTRICTED-GUEST supported.
AP(0x02): My RSP is 0x0000000019c53000, proceeding...
AP(0x01): My RSP is 0x0000000019b53000, proceeding...
CPU(0x02): UNRESTRICTED-GUEST supported.
CPU(0x01): UNRESTRICTED-GUEST supported.
CPU(0x00): MSR_EFER=0x0000000000000500
CPU(0x03): UNRESTRICTED-GUEST supported.
CPU(0x00): MSR_EFCR=0x0000000000000005
CPU(0x03): MSR_EFER=0x0000000000000500
CPU(0x00): enabled VMX
CPU(0x03): MSR_EFCR=0x0000000000000005
CPU(0x00): Entered VMX root operation
CPU(0x03): enabled VMX
CPU(0x00, BSP): initializing INT 15 hook for UG mode...
CPU(0x03): Entered VMX root operation
CPU(0x00): original INT 15h handler at 0xf000:0xf859
IA32_MTRRCAP: VCNT=8, FIX=1, WC=1, SMRR=0
BSP(0x00): copying boot-module to boot guest
_vmx_gathermemorytypes: gathered MTRR details, number of entries=96
IA32_MTRRCAP: VCNT=8, FIX=1, WC=1, SMRR=0
CPU(0x02): MSR_EFER=0x0000000000000500
_vmx_gathermemorytypes: gathered MTRR details, number of entries=96
CPU(0x02): MSR_EFCR=0x0000000000000005
CPU(0x01): MSR_EFER=0x0000000000000500
CPU(0x02): enabled VMX
CPU(0x01): MSR_EFCR=0x0000000000000005
CPU(0x02): Entered VMX root operation
CPU(0x01): enabled VMX
IA32_MTRRCAP: VCNT=8, FIX=1, WC=1, SMRR=0
CPU(0x01): Entered VMX root operation
_vmx_gathermemorytypes: gathered MTRR details, number of entries=96
IA32_MTRRCAP: VCNT=8, FIX=1, WC=1, SMRR=0
_vmx_gathermemorytypes: gathered MTRR details, number of entries=96
CPU(0x00): Activated VMX EPTs.TV[0]:appmain.c:tv_app_main:141:                   CPU(0x00)
TV[0]:appmain.c:tv_app_main:144:                   CPU(0x00): init

TV[0]:appmain.c:tv_app_main:146:                   CPU(0x00) apb->cmdline: "serial=115200,8n1,0x3f8"
TV[0]:appmain.c:parse_boot_cmdline:129:            NV Enforcement ENABLED

CPU(0x03): Activated VMX EPTs.
NV uPCR[0] required to be: TV[0]:appmain.c:tv_app_main:141:                   CPU(0x03)
00 00
CPU(0x03): AP, waiting for SIPI signal...00 00 00 00 00 00 00 00 00 00 00 00 00 00
NV uPCR[0] required to be: 00 00 00 00
TV[0]:scode.c:init_scode:331:                      alloc 110KB mem for scode_list at 1027c730!

CPU(0x02): Activated VMX EPTs.TV[0]:scode.c:init_scode:333:                      alloc 512KB mem for pfn_bitmap at 10297fd8!
TV[0]:appmain.c:tv_app_main:141:                   CPU(0x02)
TV[0]:scode.c:init_scode:335:                      alloc 512KB mem for pfn_bitmap_2M at 10317fe0!

CPU(0x02): AP, waiting for SIPI signal...TV[0]:scode.c:init_scode:343:                      whitelist max = 100!
TV[0]:scode.c:init_scode:360:                      DEVELOPMENT ONLY: skipping trustvisor_master_crypto_init().

CPU(0x00): Waiting for all cores to cycle through appmain...
CPU(0x01): Activated VMX EPTs.TV[0]:appmain.c:tv_app_main:141:                   CPU(0x01)

CPU(0x01): AP, waiting for SIPI signal...
CPU(0x00): All cores have successfully been through appmain.
CPU(0x00): setup x86vmx SMP guest capabilities
xmhf_runtime_main[00]: starting partition...
CPU(0x00): VMCLEAR success.
CPU(0x00): VMPTRLD success.
CPU(0x00): Ignoring VMWRITE failure 21 0x6008 0x0
Hidding future VMWRITE failures
CPU(0x00): VMWRITEs success.
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000000, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000001, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000002, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000003, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000004, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000005, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000006, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000007, ECX=0x00000014, ES=0x6800, DI=0x0004
CPU(0x00): INT 15(e820): AX=0xe820, EDX=0x534d4150, EBX=0x00000008, ECX=0x00000014, ES=0x6800, DI=0x0004
Set bit 9 of 'IA-32e mode guest' to EFER.LME && CR0.PG
CPU(0x00): CS:EIP=0x0008:0x0009e059 MOV CR4, xx
MOV TO CR4 (flush TLB?), current=0x00002020, proposed=0x00000020
CPU(0x00): CS:EIP=0x0010:0x06a00057 MOV CR4, xx
MOV TO CR4 (flush TLB?), current=0x00002020, proposed=0x000000a0
_vmx_handle_intercept_xsetbv: xcr_value=7
_vmx_handle_intercept_xsetbv: host cr4 value=00042020
_vmx_handle_intercept_xsetbv: xcr_value=7
_vmx_handle_intercept_xsetbv: host cr4 value=00042020
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x0000c500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x00008500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) STARTUP IPI detected, value=0x0000069a
CPU(0x00): processSIPI, dest_lapic_id is 0x01
CPU(0x00): found AP to pass SIPI; id=0x01, vcpu=0x1024af98
CPU(0x00): Sent SIPI command to AP, should awaken it!
CPU(0x01): SIPI signal received, vector=0x9a
xmhf_runtime_main[01]: starting partition...
CPU(0x01): VMCLEAR success.
CPU(0x01): VMPTRLD success.
CPU(0x01): VMWRITEs success.
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) STARTUP IPI detected, value=0x0000069a
CPU(0x00): processSIPI, dest_lapic_id is 0x01
CPU(0x00): found AP to pass SIPI; id=0x01, vcpu=0x1024af98
CPU(0x00): destination CPU #0x01 has already received SIPI, ignoring
CPU(0x01): CS:EIP=0x0010:0x9ac00057 MOV CR4, xx
MOV TO CR4 (flush TLB?), current=0x000426b0, proposed=0x000000a0
_vmx_handle_intercept_xsetbv: xcr_value=7
_vmx_handle_intercept_xsetbv: host cr4 value=00042020
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x0000c500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x00008500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) STARTUP IPI detected, value=0x0000069a
CPU(0x00): processSIPI, dest_lapic_id is 0x02
CPU(0x00): found AP to pass SIPI; id=0x02, vcpu=0x1024c710
CPU(0x00): Sent SIPI command to AP, should awaken it!
CPU(0x02): SIPI signal received, vector=0x9a
xmhf_runtime_main[02]: starting partition...
CPU(0x02): VMCLEAR success.
CPU(0x02): VMPTRLD success.
CPU(0x02): VMWRITEs success.
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) STARTUP IPI detected, value=0x0000069a
CPU(0x00): processSIPI, dest_lapic_id is 0x02
CPU(0x00): found AP to pass SIPI; id=0x02, vcpu=0x1024c710
CPU(0x00): destination CPU #0x02 has already received SIPI, ignoring
CPU(0x02): CS:EIP=0x0010:0x9ac00057 MOV CR4, xx
MOV TO CR4 (flush TLB?), current=0x000426b0, proposed=0x000000a0
_vmx_handle_intercept_xsetbv: xcr_value=7
_vmx_handle_intercept_xsetbv: host cr4 value=00042020
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x0000c500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) INIT IPI detected and skipped, value=0x00008500
0x0010:0x9ac62b68 -> (ICR=0x00000300 write) STARTUP IPI detected, value=0x0000069a
CPU(0x00): processSIPI, dest_lapic_id is 0x03
CPU(0x00): found AP to pass SIPI; id=0x03, vcpu=0x1024de88
CPU(0x00): Sent SIPI command to AP, should awaken it!
CPU(0x03): SIPI signal received, vector=0x9a
xmhf_smpguest_arch_x86_64vmx_eventhandler_dbexception: delinking LAPIC interception since all cores have SIPI
xmhf_runtime_main[03]: starting partition...
CPU(0x03): VMCLEAR success.
CPU(0x03): VMPTRLD success.
CPU(0x03): VMWRITEs success.
CPU(0x03): CS:EIP=0x0010:0x9ac00057 MOV CR4, xx
MOV TO CR4 (flush TLB?), current=0x000426b0, proposed=0x000000a0
_vmx_handle_intercept_xsetbv: xcr_value=7
_vmx_handle_intercept_xsetbv: host cr4 value=00042020
Found in xcph tableTV[0]:scode.c:scode_register:508:                  cpu 0 setting root pm from 0x10680000 to 0x10683000
TV[0]:scode.c:scode_register:508:                  cpu 1 setting root pm from 0x10681000 to 0x10683000
TV[0]:scode.c:scode_register:508:                  cpu 2 setting root pm from 0x10682000 to 0x10683000
TV[0]:scode.c:scode_register:508:                  cpu 3 setting root pm from 0x10683000 to 0x10683000
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x03): add to whitelist,  scode_info 0x5721b1b0, scode_pm 0x5721b230, gventry 0xf7ff3006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x21a3801, entry point vaddr is 0xf7ff3006, paddr is 0xcff3006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x5721b230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 5721b1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7ff3000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7fc1000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7fc0000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7fbf000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7ff3000 to 00000000f7ff3000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000cff3867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc1000 to 00000000f7fc1000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000cff4867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc0000 to 00000000f7fc0000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000cff5867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fbf000 to 00000000f7fbf000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000cff6867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x03): gva=0xf7ff3006, gpa=0xcff3006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(03): nested page fault!(rip 0xf7ff3006, gcr3 0x21a3801, gpaddr 0xcff3006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7ff3006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x566505fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff9f88cc, switch to sensitive code stack 0xf7fc0ff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7fbf010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff9f891c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x1)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7fc0fe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x03): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(03): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7fbf010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff9f891c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7fc0fe8 back to regular stack 0xff9f88cc
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff9f88d0
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(03): remove from whitelist gcr3 0x21a3801, gvaddr 0xf7ff3006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x56dc31b0, scode_pm 0x56dc3230, gventry 0xf7ffb006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0xac6b801, entry point vaddr is 0xf7ffb006, paddr is 0xca05006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x56dc3230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 56dc31b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7ffb000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7fc9000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7fc8000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7fc7000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7ffb000 to 00000000f7ffb000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ca05867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc9000 to 00000000f7fc9000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c9db867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc8000 to 00000000f7fc8000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce60867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:7 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc7000 to 00000000f7fc7000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c9d2867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7ffb006, gpa=0xca05006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7ffb006, gcr3 0xac6b801, gpaddr 0xca05006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7ffb006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x5656a5fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xfffa5c8c, switch to sensitive code stack 0xf7fc8ff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7fc7010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xfffa5cdc)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x2)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7fc8fe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7fc7010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xfffa5cdc)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7fc8fe8 back to regular stack 0xfffa5c8c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xfffa5c90
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0xac6b801, gvaddr 0xf7ffb006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x57bbe1b0, scode_pm 0x57bbe230, gventry 0xf7f3f006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0xac6b803, entry point vaddr is 0xf7f3f006, paddr is 0xce66006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x57bbe230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 57bbe1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f3f000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7f0d000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7f0c000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7f0b000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f3f000 to 00000000f7f3f000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce66867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f0d000 to 00000000f7f0d000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce6e867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f0c000 to 00000000f7f0c000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce60867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f0b000 to 00000000f7f0b000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c9db867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7f3f006, gpa=0xce66006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7f3f006, gcr3 0xac6b803, gpaddr 0xce66006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f3f006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565975fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff91ea3c, switch to sensitive code stack 0xf7f0cff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7f0b010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff91ea8c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x3)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7f0cfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7f0b010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff91ea8c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7f0cfe8 back to regular stack 0xff91ea3c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff91ea40
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0xac6b803, gvaddr 0xf7f3f006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x56c0e1b0, scode_pm 0x56c0e230, gventry 0xf7f96006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0xac6b806, entry point vaddr is 0xf7f96006, paddr is 0xd01c006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x56c0e230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 56c0e1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f96000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7f64000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7f63000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7f62000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f96000 to 00000000f7f96000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d01c867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f64000 to 00000000f7f64000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce76867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f63000 to 00000000f7f63000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d029867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f62000 to 00000000f7f62000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce60867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7f96006, gpa=0xd01c006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7f96006, gcr3 0xac6b806, gpaddr 0xd01c006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f96006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x566105fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff870efc, switch to sensitive code stack 0xf7f63ff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7f62010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff870f4c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x4)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7f63fe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7f62010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff870f4c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7f63fe8 back to regular stack 0xff870efc
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff870f00
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0xac6b806, gvaddr 0xf7f96006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x578e71b0, scode_pm 0x578e7230, gventry 0xf7fa0006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0xac6b802, entry point vaddr is 0xf7fa0006, paddr is 0xd02b006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x578e7230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 578e71b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7fa0000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7f6e000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7f6d000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7f6c000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fa0000 to 00000000f7fa0000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d02b867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f6e000 to 00000000f7f6e000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce59867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f6d000 to 00000000f7f6d000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0ae867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f6c000 to 00000000f7f6c000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d029867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7fa0006, gpa=0xd02b006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7fa0006, gcr3 0xac6b802, gpaddr 0xd02b006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7fa0006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565ca5fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xfff21a5c, switch to sensitive code stack 0xf7f6dff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7f6c010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xfff21aac)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x5)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7f6dfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7f6c010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xfff21aac)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7f6dfe8 back to regular stack 0xfff21a5c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xfff21a60
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0xac6b802, gvaddr 0xf7fa0006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x03): add to whitelist,  scode_info 0x57d801b0, scode_pm 0x57d80230, gventry 0xf7f0f006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0xac6b806, entry point vaddr is 0xf7f0f006, paddr is 0xd0ac006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x57d80230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 57d801b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f0f000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7edd000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7edc000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7edb000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f0f000 to 00000000f7f0f000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0ac867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edd000 to 00000000f7edd000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0e0867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edc000 to 00000000f7edc000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d124867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edb000 to 00000000f7edb000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c9e3867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x03): gva=0xf7f0f006, gpa=0xd0ac006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(03): nested page fault!(rip 0xf7f0f006, gcr3 0xac6b806, gpaddr 0xd0ac006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f0f006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565c65fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xffa1ccec, switch to sensitive code stack 0xf7edcff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7edb010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xffa1cd3c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x6)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7edcfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x03): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(03): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7edb010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xffa1cd3c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7edcfe8 back to regular stack 0xffa1ccec
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xffa1ccf0
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(03): remove from whitelist gcr3 0xac6b806, gvaddr 0xf7f0f006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x00): add to whitelist,  scode_info 0x581121b0, scode_pm 0x58112230, gventry 0xf7f31006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x39ab802, entry point vaddr is 0xf7f31006, paddr is 0xd0f0006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x58112230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 581121b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f31000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7eff000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7efe000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7efd000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f31000 to 00000000f7f31000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0f0867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7eff000 to 00000000f7eff000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0f1867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7efe000 to 00000000f7efe000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c987867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7efd000 to 00000000f7efd000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0f3867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x00): gva=0xf7f31006, gpa=0xd0f0006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(00): nested page fault!(rip 0xf7f31006, gcr3 0x39ab802, gpaddr 0xd0f0006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f31006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x566415fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff88b84c, switch to sensitive code stack 0xf7efeff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7efd010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff88b89c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x7)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7efefe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x00): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(00): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7efd010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff88b89c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7efefe8 back to regular stack 0xff88b84c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff88b850
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(00): remove from whitelist gcr3 0x39ab802, gvaddr 0xf7f31006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x566e41b0, scode_pm 0x566e4230, gventry 0xf7f58006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x259d802, entry point vaddr is 0xf7f58006, paddr is 0xce6b006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x566e4230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 566e41b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f58000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7f26000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7f25000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7f24000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f58000 to 00000000f7f58000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ce6b867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f26000 to 00000000f7f26000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000ca05867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f25000 to 00000000f7f25000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d142867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:7 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f24000 to 00000000f7f24000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000c9a1867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:8 num_alocd:127
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7f58006, gpa=0xce6b006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7f58006, gcr3 0x259d802, gpaddr 0xce6b006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f58006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565bb5fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff9df72c, switch to sensitive code stack 0xf7f25ff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7f24010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff9df77c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x8)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7f25fe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7f24010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff9df77c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7f25fe8 back to regular stack 0xff9df72c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff9df730
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0x259d802, gvaddr 0xf7f58006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x01): add to whitelist,  scode_info 0x579281b0, scode_pm 0x57928230, gventry 0xf7fc0006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x259d805, entry point vaddr is 0xf7fc0006, paddr is 0xd12a006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x57928230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 579281b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7fc0000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7f8e000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7f8d000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7f8c000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fc0000 to 00000000f7fc0000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d12a867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f8e000 to 00000000f7f8e000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d124867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f8d000 to 00000000f7f8d000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d12e867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f8c000 to 00000000f7f8c000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0e0867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0xf7fc0006, gpa=0xd12a006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0xf7fc0006, gcr3 0x259d805, gpaddr 0xd12a006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7fc0006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x5664f5fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xffb79d4c, switch to sensitive code stack 0xf7f8dff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7f8c010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xffb79d9c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0x9)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7f8dfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x01): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(01): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7f8c010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xffb79d9c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7f8dfe8 back to regular stack 0xffb79d4c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xffb79d50
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(01): remove from whitelist gcr3 0x259d805, gvaddr 0xf7fc0006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x02): add to whitelist,  scode_info 0x56f4e1b0, scode_pm 0x56f4e230, gventry 0xf7f0f006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x259d803, entry point vaddr is 0xf7f0f006, paddr is 0x1dc8a006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x56f4e230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 56f4e1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7f0f000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7edd000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7edc000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7edb000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7f0f000 to 00000000f7f0f000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000001dc8a867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edd000 to 00000000f7edd000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d12d867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edc000 to 00000000f7edc000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d130867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7edb000 to 00000000f7edb000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000001e70a867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:7 num_alocd:127
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x02): gva=0xf7f0f006, gpa=0x1dc8a006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(02): nested page fault!(rip 0xf7f0f006, gcr3 0x259d803, gpaddr 0x1dc8a006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7f0f006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565655fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xff8af51c, switch to sensitive code stack 0xf7edcff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7edb010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xff8af56c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0xa)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7edcfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x02): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(02): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7edb010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xff8af56c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7edcfe8 back to regular stack 0xff8af51c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xff8af520
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(02): remove from whitelist gcr3 0x259d803, gvaddr 0xf7f0f006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x02): add to whitelist,  scode_info 0x5720f1b0, scode_pm 0x5720f230, gventry 0xf7fe0006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x259d805, entry point vaddr is 0xf7fe0006, paddr is 0xd0e6006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x5720f230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 5720f1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7fe0000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7fae000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7fad000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7fac000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fe0000 to 00000000f7fe0000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d0e6867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fae000 to 00000000f7fae000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d14c867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fad000 to 00000000f7fad000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d12c867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fac000 to 00000000f7fac000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000001e70a867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:6 num_alocd:127
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x02): gva=0xf7fe0006, gpa=0xd0e6006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(02): nested page fault!(rip 0xf7fe0006, gcr3 0x259d805, gpaddr 0xd0e6006, errorcode 4)
TV[0]:scode.c:scode_in_list:192:                   find gvaddr 0xf7fe0006 in scode 0 section No.0
TV[0]:scode.c:hpt_scode_switch_scode:917:          *** to scode ***
TV[0]:scode.c:hpt_scode_switch_scode:921:          got pal_running lock!
TV[0]:scode.c:hpt_scode_switch_scode:927:          scode return vaddr is 0x565ab5fb
TV[0]:scode.c:hpt_scode_switch_scode:930:          saved guest regular stack 0xffe8a63c, switch to sensitive code stack 0xf7fadff0
TV[0]:scode.c:scode_marshall:801:                  marshalling scode parameters!
TV[0]:scode.c:scode_marshall:806:                  parameter page base address is 0xf7fac010
TV[0]:scode.c:scode_marshall:820:                  params number is 2
TV[0]:scode.c:scode_marshall:831:                  copying param 1
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:869:                  PM 1 is a pointer (size 4, value 0xffe8a68c)
TV[0]:scode.c:scode_marshall:831:                  copying param 0
TV[0]:scode.c:scode_marshall:852:                  scode_marshal copied metadata to params area
TV[0]:scode.c:scode_marshall:860:                  PM 0 is a integer (size 4, value 0xb)
TV[0]:scode.c:hpt_scode_switch_scode:949:          host stack pointer before running scode is 0xf7fadfe4
TV[0]:scode.c:hpt_scode_switch_scode:954:          change NPT permission to run PAL!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x02): gva=0x4, gpa=0x4, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(02): nested page fault!(rip 0x4, gcr3 0x10399800, gpaddr 0x4, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0x4!
TV[0]:scode.c:hpt_scode_switch_regular:1108:       ************************************
TV[0]:scode.c:hpt_scode_switch_regular:1109:       ***** switch to regular code  ******
TV[0]:scode.c:hpt_scode_switch_regular:1110:       ************************************
TV[0]:scode.c:scode_unmarshall:1021:               unmarshalling scode parameters!
TV[0]:scode.c:scode_unmarshall:1026:               parameter page base address is 0xf7fac010
TV[0]:scode.c:scode_unmarshall:1036:               params number is 2
TV[0]:scode.c:scode_unmarshall:1074:               PM 0 is a pointer (size 16, addr 0xffe8a68c)
TV[0]:scode.c:scode_unmarshall:1056:               skip an integer parameter!
TV[0]:scode.c:hpt_scode_switch_regular:1134:       change NPT permission to exit PAL!
TV[0]:scode.c:hpt_scode_switch_regular:1140:       switch from scode stack 0xf7fadfe8 back to regular stack 0xffe8a63c
TV[0]:scode.c:hpt_scode_switch_regular:1147:       stack pointer before exiting scode is 0xffe8a640
TV[0]:scode.c:hpt_scode_switch_regular:1154:       released pal_running lock!
TV[0]:scode.c:scode_unregister:706:                *** scode unregister ***
TV[0]:scode.c:scode_unregister:710:                CPU(02): remove from whitelist gcr3 0x259d805, gvaddr 0xf7fe0006
TV[1]:scode.c:scode_unregister:721:                performance counters:
TV[1]:scode.c:scode_unregister:723:                  npf total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_scode total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  switch_regular total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  safemalloc total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  marshall total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  expose_arch total: 0 count: 0
TV[1]:scode.c:scode_unregister:723:                  nested_switch_scode total: 0 count: 0
TV[0]:scode.c:scode_unregister:740:                zeroing section 1
TV[0]:scode.c:scode_unregister:740:                zeroing section 2
TV[0]:scode.c:scode_unregister:740:                zeroing section 3
TV[0]:scode.c:scode_register:525:                  *** scode register ***
TV[0]:scode.c:scode_register:529:                  CPU(0x02): add to whitelist,  scode_info 0x5759e1b0, scode_pm 0x5759e230, gventry 0xf7fe9006
TV[0]:scode.c:scode_register:541:                  CR3 value is 0x259d801, entry point vaddr is 0xf7fe9006, paddr is 0xd044006
TV[0]:scode.c:parse_params_info:378:               pm_info 0x5759e230, # of parameters is 2
TV[0]:scode.c:parse_params_info:388:               parameter 0 type 1 size 4
TV[0]:scode.c:parse_params_info:388:               parameter 1 type 2 size 4
TV[0]:scode.c:memsect_info_copy_from_guest:408:    scode_info addr 5759e1b0, # of section is 4
TV[0]:scode.c:memsect_info_register:472:           section 0 type 1 addr 0xf7fe9000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 1 type 2 addr 0xf7fb7000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 2 type 4 addr 0xf7fb6000 size 1
TV[0]:scode.c:memsect_info_register:472:           section 3 type 3 addr 0xf7fb5000 size 1
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:0 num_alocd:127
TV[0]:scode.c:scode_register:587:                  adding gpl to pal's npt:
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:scode.c:scode_register:603:                  adding sections to pal's npts and gpts:
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fe9000 to 00000000f7fe9000, size 4096, pal_prot 5
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d044867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pages.c:pagelist_get_page:72:                num_used:1 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:2 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:3 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fb7000 to 00000000f7fb7000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d14e867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fb6000 to 00000000f7fb6000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d04d867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[0]:pt.c:scode_lend_section:209:                 Mapping from 00000000f7fb5000 to 00000000f7fb5000, size 4096, pal_prot 3
TV[0]:pt.c:scode_lend_section:236:                 got pme 000000000d041867, level 1, type 2
TV[0]:pt.c:scode_lend_section:268:                 got reg gpt prots:0x7, user:1
TV[2]:scode.c:scode_register:623:                  skipping scode_clone_gdt
TV[0]:scode.c:scode_register:647:                  generated pme for return gva address 4: lvl:1 5
TV[0]:pages.c:pagelist_get_page:72:                num_used:4 num_alocd:127
TV[0]:pages.c:pagelist_get_page:72:                num_used:5 num_alocd:127
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:584: CPU(0x00): gva=0xf7fe9006, gpa=0xd044006, code=0x4
TV[0]:scode.c:hpt_scode_npf:1190:                  CPU(00): nested page fault!(rip 0xf7fe9006, gcr3 0x259d805, gpaddr 0xd044006, errorcode 4)
TV[0]:scode.c:scode_in_list:199:                   no matching scode found for gvaddr 0xf7fe9006!
TV[3]:scode.c:hpt_scode_npf:1229:                  incorrect regular code EPT configuration!
TV[0]:appmain.c:tv_app_handleintercept_hwpgtblviolation:587: FATAL ERROR: Unexpected return value from page fault handling
